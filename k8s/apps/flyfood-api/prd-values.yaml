name: flyfood-api
environment: prd

image:
  repository: oprimogusreal/cardapiogo-api
  pullPolicy: Always
  tag: latest

port: 3000

resources:
  min:
    cpu: 100m
    memory: 128Mi
  max:
    cpu: 500m
    memory: 256Mi
  autoscaling:
    enable: true
    minReplicas: 1
    maxReplicas: 2
    targetCPUUtilizationPercentage: 80
    targetMemoryUtilizationPercentage: 80

health:
  liveness:
    enabled: true
  readiness:
    enabled: true

env:
  DB_HOST: postgres-cluster-rw.infra.svc.cluster.local
  DB_PORT: 5432

  API_PORT: 3000
  API_SERVICE_NAME: flyfood-api
  API_BASE_PATH: /
  ENVIRONMENT: production
  SQLCDEBUG: 0

  ZITADEL_ISSUER: https://zitadel.infra.svc.cluster.local
  ZITADEL_DOMAIN: auth.flyfood.com.br
  ZITADEL_PORT: 8080
  ZITADEL_PROJECT_ID: 295106177753153543
  ZITADEL_CLIENT_ID: 295106214830866439
  ZITADEL_KEY: ./configs/zitadel/key.json
  ZITADEL_SERVICE_ACCOUNT_KEY: ./configs/zitadel/service_account_key.json

secrets:
  - name: DB_NAME
    secret: flyfood-db-secret
    key: DB_NAME
  
  - name: DB_USERNAME
    secret: flyfood-db-secret
    key: DB_USERNAME

  - name: DB_PASSWORD
    secret: flyfood-db-secret
    key: DB_PASSWORD  

  - name: ZITADEL_PROJECT_ID
    secret: flyfood-api-secret
    key: ZITADEL_PROJECT_ID

  - name: ZITADEL_CLIENT_ID
    secret: flyfood-api-secret
    key: ZITADEL_CLIENT_ID

  - name: ZITADEL_KEY
    secret: prd-flyfood-zitadel-key
    key: prd-flyfood-zitadel-key

  - name: ZITADEL_SERVICE_ACCOUNT_KEY
    secret: prd-flyfood-zitadel-service-account-key
    key: ZITADEL_SERVICE_ACCOUNT_KEY

ingress:
  enabled: true
  host: flyfood.com.br
  path: /api
